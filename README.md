# Sirius
Репозиторий для хранения кейса по компьютерному зрению
# Программы для обработки изображений товаров 
- для автоматического перебора огромного количества изображений применяется программа "auto_not_veb". Её достаточно просто запустить через любое приложение для Python. Естественно надо указать ключи доступа, как их получить описано ниже.
- для ручной настройки через веб-приложение поштучно применяется программа "not_auto_veb_interface", написанная на streamlit, как её запускать расписано ниже.

## Описание проекта

Этот проект предоставляет веб-интерфейс для обработки изображений товаров с помощью технологии нейросетей и машинного обучения. Основные функции включают удаление фона, замену фона, распознавание объектов и автоматическую генерацию текстовых описаний с помощью GigaChat API. Программа написана на Python с использованием библиотеки Streamlit для создания удобного интерфейса.

### Основные функции программы

1. **Удаление фона**:
    - Поддерживаются две модели для удаления фона: `rembg` и `deeplabv3`.
    - Программа автоматически удаляет фон с изображений и позволяет заменять его на однотонный цвет или загруженный пользователем фон.

2. **Замена фона**:
    - Можно заменить удалённый фон на выбранный цвет или текстуру.
    - Функция поддерживает загрузку пользовательского фона для замены.

3. **Распознавание объектов**:
    - Программа использует предобученную модель `ResNet50` для распознавания объектов на изображении.
    - После распознавания объект выводится с его названием на русском языке, пользователь может редактировать это название.

4. **Генерация описаний с использованием GigaChat**:
    - Поддерживается автоматическая генерация описаний товара с использованием GigaChat API.
    - Пользователь может выбрать стиль описания (краткое, подробное, техническое и др.).

5. **Наложение текста на изображение**:
    - Программа добавляет текстовые описания поверх изображения товара.
    - Размер и цвет шрифта могут быть настроены пользователем.

### Технологии и библиотеки

- `Python 3.8+`
- `OpenCV` — для обработки изображений.
- `Pillow (PIL)` — для работы с изображениями.
- `rembg` — для удаления фона.
- `PyTorch` и `torchvision` — для работы с нейросетями (модель `ResNet50`).
- `Streamlit` — для создания веб-приложения.
- `requests` — для работы с GigaChat API.
- `deep_translator`: используется для перевода текста.

### Установите все файлы из репозитория на компьютер
Обязательно скачайте все файлы, особенно imagenet_classes, так как он нужен нейронной сети для автораспознавания объектов! (загружать в Streamlit)

### Установка библиотек

pip install opencv-python-headless rembg torch torchvision deep_translator pillow streamlit requests

### Запуск программы

1. Запустите приложение с помощью Streamlit:

    ```bash
    streamlit run main.py
    ```

2. Откройте браузер, чтобы увидеть интерфейс программы, отображение будет через localhost

### Использование

1. Загрузите изображение товара.
2. Выберите модель для удаления фона (`rembg` или `deeplabv3`).
3. Замените фон на цвет или загруженный фон.
4. Программа распознает объект на изображении. Вы можете отредактировать название объекта, если оно распознано неправильно.
5. Сгенерируйте описание товара с помощью GigaChat, выбрав стиль описания.
6. Добавьте текстовое описание поверх изображения.
7. Сохраните итоговое изображение.

### Пример

1. Исходное изображение:
    ![Исходное изображение](./images/example_input.jpg)

2. Обработанное изображение:
    ![Обработанное изображение](./images/example_output.jpg)

### Настройки

- **Выбор стиля описания**: Краткое, подробное, рекламное и др.
- **Настройки текста**: Цвет текста, размер шрифта.
- **Загрузка фона**: Вы можете загрузить собственный фон для замены.

### API

Для работы с GigaChat необходимо получить API-токен:
1. Программа автоматически создаёт API-токен через функцию, чтобы программа заработала нужно подключить нейросеть для генерации описания.
2. Зарегистрируйтесь на платформе GigaChat API (меньше минуты по времени, так как вход по номеру через Сбер).
3. Скопируйте secret_key, client_id, authorization и вставьте ключи в код в начале программы там где пустые кавычки.
4. Можете приступать к изучению программы и интерфейса!
